# smartspec_validate_ui_spec

**Validate A2UI-compliant UI specifications with auto-correction.**

## Purpose

This workflow validates UI specifications generated by `smartspec_generate_ui_spec` to ensure they comply with A2UI standards, design system guidelines, accessibility requirements, and naming conventions. It can automatically fix common issues.

## Features

âœ… **Structure Validation** - Validates A2UI structure and required fields  
âœ… **Component Validation** - Validates component definitions and types  
âœ… **Naming Convention** - Enforces kebab-case for component IDs  
âœ… **Accessibility** - Checks for aria-labels and accessibility attributes  
âœ… **Auto-Correction** - Automatically fixes common issues  
âœ… **Comprehensive Reporting** - Detailed validation reports

---

## Usage

### Preview Mode (Default)

```bash
python3 .smartspec/scripts/validate_ui_spec.py specs/feature/spec-001-booking/ui-spec.json
```

**Output:**
- Validation results
- List of issues found
- Available auto-fixes
- Recommendations

### Apply Mode (Auto-Fix)

```bash
python3 .smartspec/scripts/validate_ui_spec.py specs/feature/spec-001-booking/ui-spec.json --apply
```

**Output:**
- Validation results
- Applied fixes
- Updated spec file

### With Custom Catalog

```bash
python3 .smartspec/scripts/validate_ui_spec.py \
  specs/feature/spec-001-booking/ui-spec.json \
  --catalog .spec/custom-catalog.json \
  --apply
```

---

## Validation Rules

### 1. Structure Validation

**Required Fields:**
- `version` - A2UI version (e.g., "0.8")
- `metadata` - Spec metadata
- `components` - Component definitions
- `layout` - Layout configuration

**Example:**
```json
{
  "version": "0.8",
  "metadata": { ... },
  "components": [ ... ],
  "layout": { ... }
}
```

---

### 2. Version Validation

**Format:** `X.Y` (e.g., "0.8", "1.0")

**Valid:**
- "0.8"
- "1.0"
- "2.1"

**Invalid:**
- "0.8.0" (too many parts)
- "v0.8" (prefix not allowed)
- "latest" (not a version)

---

### 3. Metadata Validation

**Required Fields:**
- `name` - Spec name
- `description` - Spec description
- `platform` - Target platform (web, flutter, mobile, all)

**Example:**
```json
{
  "metadata": {
    "name": "Restaurant Booking Form",
    "description": "UI for restaurant booking",
    "platform": "web"
  }
}
```

---

### 4. Component Validation

**Required Fields per Component:**
- `id` - Component ID (kebab-case)
- `type` - Component type
- `props` - Component properties

**Naming Convention:**
- Component IDs MUST be kebab-case
- Valid: `booking-form`, `date-input`, `submit-btn`
- Invalid: `bookingForm`, `dateInput`, `submitBtn`

**Auto-Fix:**
- Converts camelCase â†’ kebab-case
- Converts PascalCase â†’ kebab-case
- Converts snake_case â†’ kebab-case

**Example:**
```json
{
  "id": "booking-form",
  "type": "form",
  "props": {
    "method": "POST"
  }
}
```

---

### 5. Accessibility Validation

**Interactive Components:**
- `button`, `input`, `select`, `checkbox`, `radio`

**Requirements:**
- MUST have `aria-label` OR `label` prop
- MUST have descriptive text

**Auto-Fix:**
- Generates aria-label from component ID
- Example: `date-input` â†’ "Date Input"

**Example:**
```json
{
  "id": "submit-btn",
  "type": "button",
  "props": {
    "type": "submit",
    "aria-label": "Submit booking"
  }
}
```

---

### 6. Layout Validation

**Required:**
- Layout section must exist
- Layout type must be specified

**Valid Types:**
- `vertical`, `horizontal`, `grid`, `flex`

**Example:**
```json
{
  "layout": {
    "type": "vertical",
    "spacing": "medium",
    "children": ["booking-form"]
  }
}
```

---

## Auto-Correction

### Component ID Fixes

**Before:**
```json
{
  "id": "bookingForm",
  "type": "form"
}
```

**After:**
```json
{
  "id": "booking-form",
  "type": "form"
}
```

---

### Accessibility Fixes

**Before:**
```json
{
  "id": "date-input",
  "type": "input",
  "props": {
    "type": "date"
  }
}
```

**After:**
```json
{
  "id": "date-input",
  "type": "input",
  "props": {
    "type": "date",
    "aria-label": "Date Input"
  }
}
```

---

## Validation Report

### Report Format

```
============================================================
UI Spec Validation Report
============================================================
Spec: specs/feature/spec-001-booking/ui-spec.json
Timestamp: 2025-12-27 10:00:00
Mode: PREVIEW

Issues Found: 7
  - Errors: 0
  - Warnings: 7
Fixes Available: 7

Issues:
------------------------------------------------------------
1. âš ï¸  [component] Component 0: ID should be kebab-case: bookingForm
2. âš ï¸  [accessibility] Component 1 (input): Missing aria-label or label

Available Fixes:
------------------------------------------------------------
1. ðŸ”§ [component_id] Convert component ID to kebab-case: bookingForm â†’ booking-form
2. ðŸ”§ [accessibility] Add aria-label: Date Input

âš ï¸  Validation PASSED with warnings: Consider fixing warnings

â„¹ï¸  Run with --apply to automatically fix issues
============================================================
```

---

## Integration with generate_ui_spec

### Workflow Integration

**Step 1: Generate UI Spec**
```bash
/smartspec_generate_ui_spec \
  --requirements "Create booking form" \
  --spec specs/feature/spec-001-booking/ui-spec.json \
  --apply
```

**Step 2: Validate UI Spec**
```bash
python3 .smartspec/scripts/validate_ui_spec.py \
  specs/feature/spec-001-booking/ui-spec.json
```

**Step 3: Fix Issues (if any)**
```bash
python3 .smartspec/scripts/validate_ui_spec.py \
  specs/feature/spec-001-booking/ui-spec.json \
  --apply
```

**Step 4: Verify**
```bash
python3 .smartspec/scripts/validate_ui_spec.py \
  specs/feature/spec-001-booking/ui-spec.json
```

---

## Best Practices

### 1. Always Validate After Generation

```bash
# Generate
/smartspec_generate_ui_spec --requirements "..." --spec ui-spec.json --apply

# Validate immediately
python3 .smartspec/scripts/validate_ui_spec.py ui-spec.json
```

### 2. Preview Before Applying

```bash
# Preview fixes first
python3 .smartspec/scripts/validate_ui_spec.py ui-spec.json

# Review output, then apply
python3 .smartspec/scripts/validate_ui_spec.py ui-spec.json --apply
```

### 3. Use Custom Catalog for Project-Specific Components

```bash
python3 .smartspec/scripts/validate_ui_spec.py \
  ui-spec.json \
  --catalog .spec/my-custom-catalog.json
```

### 4. Automate in CI/CD

```yaml
# .github/workflows/validate-ui-specs.yml
- name: Validate UI Specs
  run: |
    find specs -name "ui-spec.json" | while read spec; do
      python3 .smartspec/scripts/validate_ui_spec.py "$spec"
    done
```

---

## Exit Codes

| Code | Meaning |
|:-----|:--------|
| 0 | Validation passed (no errors) |
| 1 | Validation failed (errors found) |

**Note:** Warnings do not cause failure (exit code 0)

---

## Examples

### Example 1: Valid Spec

```bash
$ python3 .smartspec/scripts/validate_ui_spec.py ui-spec.json

âœ… Structure validation passed
âœ… Version validation passed: 0.8
âœ… Metadata validation passed
âœ… Components validation passed (5 components)
âœ… Accessibility validation passed
âœ… Layout validation passed

âœ… Validation PASSED: Spec is ready to use
```

### Example 2: Spec with Warnings

```bash
$ python3 .smartspec/scripts/validate_ui_spec.py ui-spec.json

âš ï¸  Accessibility validation completed with warnings

Issues Found: 3
  - Errors: 0
  - Warnings: 3

âš ï¸  Validation PASSED with warnings: Consider fixing warnings
â„¹ï¸  Run with --apply to automatically fix issues
```

### Example 3: Auto-Fix Applied

```bash
$ python3 .smartspec/scripts/validate_ui_spec.py ui-spec.json --apply

ðŸ”§ Applying 7 fix(es)...
  âœ… Fixed component 0 ID: bookingForm â†’ booking-form
  âœ… Added aria-label to component 1: Date Input

âœ… Applied 7 fix(es) to ui-spec.json
```

---

## Troubleshooting

### Issue: "Component catalog not found"

**Cause:** `.spec/ui-catalog.json` doesn't exist

**Solution:**
- Create catalog file
- Or use `--catalog` flag with custom path
- Or ignore (catalog validation is optional)

### Issue: "Invalid JSON in UI spec"

**Cause:** Malformed JSON

**Solution:**
- Check JSON syntax
- Use JSON validator
- Fix syntax errors

### Issue: "Missing required field"

**Cause:** Required A2UI field missing

**Solution:**
- Add missing field manually
- Or regenerate spec with correct structure

---

## Pattern for Other Workflows

This validation tool demonstrates the "Prevention > Cure" pattern:

1. âœ… **Validate at generation time** - Catch issues early
2. âœ… **Auto-correction** - Fix common issues automatically
3. âœ… **Clear reporting** - Show what's wrong and how to fix
4. âœ… **Preview/Apply modes** - Safe by default
5. âœ… **Integration-ready** - Easy to integrate into workflows

**Apply this pattern to:**
- `generate_spec` â†’ `validate_spec.py`
- `generate_plan` â†’ `validate_plan.py`
- `generate_tests` â†’ `validate_tests.py`
- etc.

---

## Version History

**v1.0.0 (2025-12-27)** - Proof of Concept
- Initial release
- Structure validation
- Component validation
- Naming convention enforcement
- Accessibility validation
- Auto-correction
- Comprehensive reporting

---

## Related Workflows

- `smartspec_generate_ui_spec` - Generate UI specifications
- `smartspec_implement_ui_from_spec` - Implement UI from spec
- `smartspec_validate_naming_convention` - Validate file naming

---

**Status:** âœ… Proof of Concept Complete  
**Pattern:** Prevention > Cure  
**Template:** Ready for replication
